<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
.AlignLeft { text-align: left; }
.AlignCenter { text-align: center; }
.AlignRight { text-align: right; }
body { font-family: sans-serif; font-size: 11pt; }
img.AutoScale { max-width: 100%; max-height: 100%; }
td { vertical-align: top; padding-left: 4px; padding-right: 4px; }

tr.SectionGap td { font-size: 4px; border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.SectionAll td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.SectionBegin td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.SectionEnd td { border-left: none; border-top: none; border-bottom: 1px solid Black; border-right: 1px solid Black; }
tr.SectionMiddle td { border-left: none; border-top: none; border-right: 1px solid Black; }
tr.SubsectionAll td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
tr.SubsectionEnd td { border-left: none; border-top: none; border-bottom: 1px solid Gray; border-right: 1px solid Black; }
table.fc { border-top: 1px solid Black; border-left: 1px solid Black; width: 100%; font-family: monospace; font-size: 10pt; }
td.TextItemInsigMod { color: #000000; background-color: #EEEEFF; }
td.TextItemInsigOrphan { color: #000000; background-color: #FAEEFF; }
td.TextItemNum { color: #696969; background-color: #ECECEC; }
td.TextItemSame { color: #000000; background-color: #FFFFFF; }
td.TextItemSigMod { color: #000000; background-color: #FFE3E3; }
td.TextItemSigOrphan { color: #000000; background-color: #F1E3FF; }
.TextSegInsigDiff { color: #0000FF; }
.TextSegReplacedDiff { color: #0000FF; font-style: italic; }
.TextSegSigDiff { color: #FF0000; }
td.TextItemInsigAdd { color: #000000; background-color: #EEEEFF; }
td.TextItemInsigDel { color: #000000; background-color: #EEEEFF; text-decoration: line-through; }
td.TextItemSigAdd { color: #000000; background-color: #FFE3E3; }
td.TextItemSigDel { color: #000000; background-color: #FFE3E3; text-decoration: line-through; }
.TextSegElementKeyword { font-weight: bold; }
.TextSegElementIdentifier { }
.TextSegElementString { color: #3A7726; }
.TextSegElementComment { color: #786A41; }
.TextSegElementOperator { }
.TextSegElementIndentation { }
</style>
<title>File Comparison</title>
</head>
<body>
File Comparison<br>
Produced: 10/26/20 5:04:30 PM<br>
&nbsp; &nbsp;
<br>
Mode:&nbsp; All, With Context, Ignoring Unimportant &nbsp;
<br>
Left file: /Users/msmolyak/Projects/Cora/DeepSpeedExamples/Megatron-LM/data_utils/tokenization_gpt2.py &nbsp;
<br>
Right file: /Users/msmolyak/Projects/Cora/DeepSpeedExamplesISI/Megatron-LM/data_utils/tokenization_gpt2.py &nbsp;
<br>
<table class="fc" cellspacing="0" cellpadding="0">
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">1</td>
<td class="TextItemSame"><span class="TextSegElementComment"># coding=utf-8</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">1</td>
<td class="TextItemSame"><span class="TextSegElementComment"># coding=utf-8</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">2</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Copyright 2018 The Open AI Team Authors and The HuggingFace Inc. team.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">2</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Copyright 2018 The Open AI Team Authors and The HuggingFace Inc. team.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">3</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">3</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">4</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">4</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">5</td>
<td class="TextItemSame"><span class="TextSegElementComment"># you may not use this file except in compliance with the License.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">5</td>
<td class="TextItemSame"><span class="TextSegElementComment"># you may not use this file except in compliance with the License.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">6</td>
<td class="TextItemSame"><span class="TextSegElementComment"># You may obtain a copy of the License at</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">6</td>
<td class="TextItemSame"><span class="TextSegElementComment"># You may obtain a copy of the License at</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">7</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">7</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">8</td>
<td class="TextItemSame"><span class="TextSegElementComment">#&nbsp; &nbsp;&nbsp; http://www.apache.org/licenses/LICENSE-2.0</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">8</td>
<td class="TextItemSame"><span class="TextSegElementComment">#&nbsp; &nbsp;&nbsp; http://www.apache.org/licenses/LICENSE-2.0</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">9</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">9</td>
<td class="TextItemSame"><span class="TextSegElementComment">#</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">10</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Unless required by applicable law or agreed to in writing, software</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">10</td>
<td class="TextItemSame"><span class="TextSegElementComment"># Unless required by applicable law or agreed to in writing, software</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">11</td>
<td class="TextItemSame"><span class="TextSegElementComment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">11</td>
<td class="TextItemSame"><span class="TextSegElementComment"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">12</td>
<td class="TextItemSame"><span class="TextSegElementComment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">12</td>
<td class="TextItemSame"><span class="TextSegElementComment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">13</td>
<td class="TextItemSame"><span class="TextSegElementComment"># See the License for the specific language governing permissions and</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">13</td>
<td class="TextItemSame"><span class="TextSegElementComment"># See the License for the specific language governing permissions and</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">14</td>
<td class="TextItemSame"><span class="TextSegElementComment"># limitations under the License.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">14</td>
<td class="TextItemSame"><span class="TextSegElementComment"># limitations under the License.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">15</td>
<td class="TextItemSame"><span class="TextSegElementString">&quot;&quot;&quot;Tokenization classes for OpenAI GPT.&quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">15</td>
<td class="TextItemSame"><span class="TextSegElementString">&quot;&quot;&quot;Tokenization classes for OpenAI GPT.&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">16</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">__future__</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">absolute_import</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">division</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">print_function</span><span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">16</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">__future__</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">absolute_import</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">division</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">print_function</span><span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">17</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">unicode_literals</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">17</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">unicode_literals</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">18</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">18</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">19</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">sys</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">19</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">sys</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">20</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">json</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">20</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">json</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">21</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">logging</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">21</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">logging</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">22</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">os</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">22</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">os</span></td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">23</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">import</span> <span class="TextSegSigDiff">shutil</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">23</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">regex</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">re</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">24</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">regex</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">re</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">24</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">io</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">open</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">25</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">io</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">open</span></td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">26</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">import</span> <span class="TextSegSigDiff">torch</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">25</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">27</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">26</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">try</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">28</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">try</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">27</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">functools</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">lru_cache</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">29</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">from</span> <span class="TextSegElementIdentifier">functools</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">lru_cache</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">28</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">except</span> <span class="TextSegElementIdentifier">ImportError</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">30</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">except</span> <span class="TextSegElementIdentifier">ImportError</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">29</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp;&nbsp; # Just a dummy decorator to get the checks to run on python2</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">31</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp;&nbsp; # Just a dummy decorator to get the checks to run on python2</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">30</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp;&nbsp; # because honestly I don't want to support a byte-level unicode BPE tokenizer on python 2 right now.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">32</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp;&nbsp; # because honestly I don't want to support a byte-level unicode BPE tokenizer on python 2 right now.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">31</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">lru_cache</span><span class="TextSegElementOperator">()</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">33</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">lru_cache</span><span class="TextSegElementOperator">()</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">32</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">func</span>: <span class="TextSegElementIdentifier">func</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">34</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">func</span>: <span class="TextSegElementIdentifier">func</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">33</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">35</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">34</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">file_utils</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">cached_path</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">36</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">from</span> <span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">file_utils</span> <span class="TextSegElementKeyword">import</span> <span class="TextSegElementIdentifier">cached_path</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">35</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">37</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">36</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">logger</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">logging</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">getLogger</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">__name__</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">38</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">logger</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">logging</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">getLogger</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">__name__</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">37</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">39</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">38</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">40</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">39</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: <span class="TextSegElementString">&quot;https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json&quot;</span><span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">41</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: <span class="TextSegElementString">&quot;https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json&quot;</span><span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">40</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">42</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">41</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_MERGES_ARCHIVE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">43</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_MERGES_ARCHIVE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">42</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: <span class="TextSegElementString">&quot;https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt&quot;</span><span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">44</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: <span class="TextSegElementString">&quot;https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt&quot;</span><span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">43</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">45</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">44</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">46</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">45</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: 1024<span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">47</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">'gpt2'</span>: 1024<span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">46</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">48</td>
<td class="TextItemSame"><span class="TextSegElementOperator">}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">47</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">VOCAB_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'vocab.json'</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">49</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">VOCAB_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'vocab.json'</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">48</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">MERGES_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'merges.txt'</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">50</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">MERGES_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'merges.txt'</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">49</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'special_tokens.txt'</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">51</td>
<td class="TextItemSame"><span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">'special_tokens.txt'</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">50</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">52</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">51</td>
<td class="TextItemSame"><span class="TextSegElementOperator">@</span><span class="TextSegElementIdentifier">lru_cache</span><span class="TextSegElementOperator">()</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">53</td>
<td class="TextItemSame"><span class="TextSegElementOperator">@</span><span class="TextSegElementIdentifier">lru_cache</span><span class="TextSegElementOperator">()</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">52</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">bytes_to_unicode</span><span class="TextSegElementOperator">()</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">54</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">bytes_to_unicode</span><span class="TextSegElementOperator">()</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">53</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">55</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">54</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; Returns list of utf-8 byte and a corresponding list of unicode strings.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">56</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; Returns list of utf-8 byte and a corresponding list of unicode strings.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">55</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; The reversible bpe codes work on unicode strings.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">57</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; The reversible bpe codes work on unicode strings.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">56</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; This means you need a large # of unicode characters in your vocab if you want to avoid UNKs.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">58</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; This means you need a large # of unicode characters in your vocab if you want to avoid UNKs.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">57</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; When you're at something like a 10B token dataset you end up needing around 5K for decent coverage.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">59</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; When you're at something like a 10B token dataset you end up needing around 5K for decent coverage.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">58</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; This is a signficant percentage of your normal, say, 32K bpe vocab.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">60</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; This is a signficant percentage of your normal, say, 32K bpe vocab.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">59</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; To avoid that, we want lookup tables between utf-8 bytes and unicode strings.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">61</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; To avoid that, we want lookup tables between utf-8 bytes and unicode strings.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">60</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; And avoids mapping to whitespace/control characters the bpe code barfs on.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">62</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; And avoids mapping to whitespace/control characters the bpe code barfs on.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">61</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">63</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">62</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">_chr</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">unichr</span> <span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">sys</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">version_info</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> 2 <span class="TextSegElementKeyword">else</span> <span class="TextSegElementIdentifier">chr</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">64</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">_chr</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">unichr</span> <span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">sys</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">version_info</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> 2 <span class="TextSegElementKeyword">else</span> <span class="TextSegElementIdentifier">chr</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">63</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;!&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;~&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))+</span><span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;¡&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;¬&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))+</span><span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;®&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;ÿ&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">65</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;!&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;~&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))+</span><span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;¡&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;¬&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))+</span><span class="TextSegElementIdentifier">list</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;®&quot;</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">ord</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;ÿ&quot;</span><span class="TextSegElementOperator">)+</span>1<span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">64</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">[</span>:<span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">66</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">[</span>:<span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">65</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">n</span> <span class="TextSegElementOperator">=</span> 0</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">67</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">n</span> <span class="TextSegElementOperator">=</span> 0</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">66</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">b</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span>2<span class="TextSegElementOperator">**</span>8<span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">68</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">b</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span>2<span class="TextSegElementOperator">**</span>8<span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">67</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">b</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">bs</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">69</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">b</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">bs</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">68</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">b</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">70</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">b</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">69</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span>2<span class="TextSegElementOperator">**</span>8<span class="TextSegElementOperator">+</span><span class="TextSegElementIdentifier">n</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">71</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span>2<span class="TextSegElementOperator">**</span>8<span class="TextSegElementOperator">+</span><span class="TextSegElementIdentifier">n</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">70</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">n</span> <span class="TextSegElementOperator">+=</span> 1</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">72</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">n</span> <span class="TextSegElementOperator">+=</span> 1</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">71</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">_chr</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">n</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">n</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">73</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">cs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">_chr</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">n</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">n</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">72</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">zip</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">74</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">zip</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cs</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">73</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">75</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">74</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">76</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">75</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Return set of symbol pairs in a word.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">77</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Return set of symbol pairs in a word.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">76</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">78</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">77</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; Word is represented as tuple of symbols (symbols being variable-length strings).</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">79</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; Word is represented as tuple of symbols (symbols being variable-length strings).</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">78</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">80</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">79</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">set</span><span class="TextSegElementOperator">()</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">81</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">set</span><span class="TextSegElementOperator">()</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">80</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">prev_char</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">82</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementIdentifier">prev_char</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">81</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">char</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span>1:<span class="TextSegElementOperator">]</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">83</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">char</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span>1:<span class="TextSegElementOperator">]</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">82</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">add</span><span class="TextSegElementOperator">((</span><span class="TextSegElementIdentifier">prev_char</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">char</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">84</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">add</span><span class="TextSegElementOperator">((</span><span class="TextSegElementIdentifier">prev_char</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">char</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">83</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">prev_char</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">char</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">85</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">prev_char</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">char</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">84</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">pairs</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">86</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">pairs</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">85</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">87</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">86</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">class</span> <span class="TextSegElementIdentifier">GPT2Tokenizer</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">object</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">88</td>
<td class="TextItemSame"><span class="TextSegElementKeyword">class</span> <span class="TextSegElementIdentifier">GPT2Tokenizer</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">object</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">87</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">89</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">88</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; GPT-2 BPE tokenizer. Peculiarities:</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">90</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; GPT-2 BPE tokenizer. Peculiarities:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">89</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; - Byte-level BPE</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">91</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; - Byte-level BPE</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">90</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">92</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp;&nbsp; &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">91</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementOperator">@</span><span class="TextSegElementIdentifier">classmethod</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">93</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementOperator">@</span><span class="TextSegElementIdentifier">classmethod</span></td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">92</td>
<td class="TextItemSigMod">&nbsp;&nbsp;&nbsp; def from_pretrained(cls, pretrained_model_name_or_path, cache_dir=None, *inputs, **kwargs):</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="TextItemNum AlignRight">94</td>
<td class="TextItemSigMod">&nbsp;&nbsp;&nbsp; def from_pretrained(cls, pretrained_model_name_or_path, <span class="TextSegSigDiff">max_len</span><span class="TextSegSigDiff">,</span> cach<span class="TextSegSigDiff">e_dir</span><span class="TextSegSigDiff">=</span><span class="TextSegSigDiff">None</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">sav</span>e_dir=None, *inputs, **kwargs):</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">93</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">95</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">94</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Instantiate a PreTrainedBertModel from a pre-trained model file.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">96</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Instantiate a PreTrainedBertModel from a pre-trained model file.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">95</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Download and cache the pre-trained model file if needed.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">97</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Download and cache the pre-trained model file if needed.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">96</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">98</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">97</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">pretrained_model_name_or_path</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">99</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">pretrained_model_name_or_path</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">98</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">100</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">99</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_MERGES_ARCHIVE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">101</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_MERGES_ARCHIVE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">100</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">None</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">102</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">None</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">101</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">103</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">102</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">VOCAB_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">104</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">VOCAB_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">103</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">MERGES_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">105</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">MERGES_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">104</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">106</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">105</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">exists</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">107</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">exists</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">106</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">None</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">108</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">None</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">107</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">109</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">108</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading special tokens file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">110</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading special tokens file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">109</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # redirect to the cache, if necessary</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">111</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # redirect to the cache, if necessary</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">110</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">try</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">112</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">try</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">111</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">resolved_vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cached_path</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">113</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">resolved_vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cached_path</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">112</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">resolved_merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cached_path</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">114</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">resolved_merges_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cached_path</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">cache_dir</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">113</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">except</span> <span class="TextSegElementIdentifier">EnvironmentError</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">115</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">except</span> <span class="TextSegElementIdentifier">EnvironmentError</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">114</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">error</span><span class="TextSegElementOperator">(</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">116</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">error</span><span class="TextSegElementOperator">(</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">115</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;Model name '{}' was not found in model name list ({}). &quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">117</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;Model name '{}' was not found in model name list ({}). &quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">116</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;We assumed '{}' was a path or url but couldn't find files {} and {} &quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">118</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;We assumed '{}' was a path or url but couldn't find files {} and {} &quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">117</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;at this path or url.&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">119</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;at this path or url.&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">118</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">120</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">119</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">', '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">keys</span><span class="TextSegElementOperator">()),</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">121</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">', '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">PRETRAINED_VOCAB_ARCHIVE_MAP</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">keys</span><span class="TextSegElementOperator">()),</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">120</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">122</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">,</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">121</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">123</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">122</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementKeyword">None</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">124</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementKeyword">None</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">123</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">resolved_vocab_file</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">resolved_merges_file</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">merges_file</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">125</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">resolved_vocab_file</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">resolved_merges_file</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">merges_file</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">124</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading vocabulary file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">126</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading vocabulary file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">125</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading merges file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">127</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading merges file {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">126</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">128</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">127</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading vocabulary file {} from cache at {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">129</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading vocabulary file {} from cache at {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">128</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_vocab_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">130</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_vocab_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">129</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading merges file {} from cache at {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">131</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;loading merges file {} from cache at {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">130</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_merges_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">132</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_merges_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">131</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if pretrained_model_name_or_path in PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP:</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="TextItemNum AlignRight">133</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if <span class="TextSegSigDiff">max_len</span> <span class="TextSegSigDiff">is</span> <span class="TextSegSigDiff">None</span> <span class="TextSegSigDiff">and</span> pretrained_model_name_or_path in PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP:</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">132</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # if we're using a pretrained model, ensure the tokenizer wont index sequences longer</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">134</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # if we're using a pretrained model, ensure the tokenizer wont index sequences longer</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">133</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # than the number of positional embeddings</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">135</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # than the number of positional embeddings</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">134</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">136</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">PRETRAINED_VOCAB_POSITIONAL_EMBEDDINGS_SIZE_MAP</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">pretrained_model_name_or_path</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">137</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">138</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">max_len</span> <span class="TextSegSigDiff">is</span> <span class="TextSegSigDiff">not</span> <span class="TextSegSigDiff">None</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">135</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">[</span><span class="TextSegElementString">'max_len'</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">min</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'max_len'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">int</span><span class="TextSegElementOperator">(</span>1<span class="TextSegElementIdentifier">e12</span><span class="TextSegElementOperator">)),</span> <span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">139</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">[</span><span class="TextSegElementString">'max_len'</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">min</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'max_len'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">int</span><span class="TextSegElementOperator">(</span>1<span class="TextSegElementIdentifier">e12</span><span class="TextSegElementOperator">)),</span> <span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">140</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">136</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # Instantiate tokenizer.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">141</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # Instantiate tokenizer.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">137</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementString">'special_tokens'</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">kwargs</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">142</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementString">'special_tokens'</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">kwargs</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">138</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">).</span><span class="TextSegElementIdentifier">read</span><span class="TextSegElementOperator">().</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)[</span>:<span class="TextSegElementOperator">-</span>1<span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">143</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">).</span><span class="TextSegElementIdentifier">read</span><span class="TextSegElementOperator">().</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)[</span>:<span class="TextSegElementOperator">-</span>1<span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">139</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">144</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">140</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">pop</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'special_tokens'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">[])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">145</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">pop</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'special_tokens'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">[])</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">146</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">147</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">save_dir</span> <span class="TextSegSigDiff">and</span> <span class="TextSegSigDiff">torch</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">distributed</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">get_rank</span><span class="TextSegSigDiff">()</span> <span class="TextSegSigDiff">==</span> <span class="TextSegSigDiff">0:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">148</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">logger</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">info</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">&quot;copying vocab and merges files to&nbsp; {}&quot;</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">format</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">save_dir</span><span class="TextSegSigDiff">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">149</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">os</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">makedirs</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">save_dir</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">exist_ok</span><span class="TextSegSigDiff">=</span><span class="TextSegSigDiff">True</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">150</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">shutil</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">copy</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">resolved_vocab_file</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">save_dir</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">151</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">shutil</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">copy</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">resolved_merges_file</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">save_dir</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">152</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">141</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokenizer</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cls</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">resolved_vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">*</span><span class="TextSegElementIdentifier">inputs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">**</span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">153</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokenizer</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">cls</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">resolved_vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">resolved_merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">*</span><span class="TextSegElementIdentifier">inputs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementOperator">**</span><span class="TextSegElementIdentifier">kwargs</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">142</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">tokenizer</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">154</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">tokenizer</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">143</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">155</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">144</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">__init__</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'replace'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">None</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">None</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">156</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">__init__</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'replace'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">None</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">None</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">145</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementKeyword">is</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">None</span> <span class="TextSegElementKeyword">else</span> <span class="TextSegElementIdentifier">int</span><span class="TextSegElementOperator">(</span>1<span class="TextSegElementIdentifier">e12</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">157</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">max_len</span> <span class="TextSegElementKeyword">is</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">None</span> <span class="TextSegElementKeyword">else</span> <span class="TextSegElementIdentifier">int</span><span class="TextSegElementOperator">(</span>1<span class="TextSegElementIdentifier">e12</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">146</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">json</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">load</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">158</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">json</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">load</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">147</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span><span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">159</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span><span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">148</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">errors</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementComment"> # how to handle errors in decoding</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">160</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">errors</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementComment"> # how to handle errors in decoding</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">149</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_encoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bytes_to_unicode</span><span class="TextSegElementOperator">()</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">161</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_encoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bytes_to_unicode</span><span class="TextSegElementOperator">()</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">150</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">162</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">151</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_data</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">).</span><span class="TextSegElementIdentifier">read</span><span class="TextSegElementOperator">().</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)[</span>1:<span class="TextSegElementOperator">-</span>1<span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">163</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_data</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merges_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">).</span><span class="TextSegElementIdentifier">read</span><span class="TextSegElementOperator">().</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)[</span>1:<span class="TextSegElementOperator">-</span>1<span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">152</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_merges</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">())</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">merge</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">bpe_data</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">164</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_merges</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">split</span><span class="TextSegElementOperator">())</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">merge</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">bpe_data</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">153</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">zip</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_merges</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_merges</span><span class="TextSegElementOperator">))))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">165</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">zip</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_merges</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">range</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_merges</span><span class="TextSegElementOperator">))))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">154</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">166</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">155</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">167</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">156</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # Should haved added re.IGNORECASE so BPE merges can happen for capitalized versions of contractions</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">168</td>
<td class="TextItemSame"><span class="TextSegElementComment">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; # Should haved added re.IGNORECASE so BPE merges can happen for capitalized versions of contractions</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">157</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; self.pat = re.compile(r&quot;&quot;&quot;'s|'t|'re|'ve|'m|'ll|'d| ?\p{L}+| ?\p{N}+| ?[^\s\p{L}\p{N}]+|\s+(?!\S)|\s+&quot;&quot;&quot;)</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="TextItemNum AlignRight">169</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; self.pat<span class="TextSegSigDiff">:</span> <span class="TextSegSigDiff">re</span> = re.compile(r&quot;&quot;&quot;'s|'t|'re|'ve|'m|'ll|'d| ?\p{L}+| ?\p{N}+| ?[^\s\p{L}\p{N}]+|\s+(?!\S)|\s+&quot;&quot;&quot;)</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">170</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">eot_pat</span><span class="TextSegSigDiff">:</span> <span class="TextSegSigDiff">re</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">re</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">compile</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">r</span><span class="TextSegSigDiff">&quot;&quot;&quot;(\&lt;\|[^\|\&lt;\&gt;]+?\|\&gt;)&quot;&quot;&quot;</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">158</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">171</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">159</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">172</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">160</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">173</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">161</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">set_special_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">174</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">set_special_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">162</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">175</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">163</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">__len__</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">176</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">__len__</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">164</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">177</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">165</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">178</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">166</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">set_special_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">179</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">set_special_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">167</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Add a list of additional tokens to the encoder.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">180</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Add a list of additional tokens to the encoder.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">168</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; The additional tokens are indexed starting from the last index of the</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">181</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; The additional tokens are indexed starting from the last index of the</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">169</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; current vocabulary in the order of the `special_tokens` list.</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">182</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; current vocabulary in the order of the `special_tokens` list.</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">170</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">183</td>
<td class="TextItemSame"><span class="TextSegElementString">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">171</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">special_tokens</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">184</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">special_tokens</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">172</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">185</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">173</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">186</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">174</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">187</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">175</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">((</span><span class="TextSegElementIdentifier">tok</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tok</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">enumerate</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">188</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">dict</span><span class="TextSegElementOperator">((</span><span class="TextSegElementIdentifier">tok</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tok</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">enumerate</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">176</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">189</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">{</span><span class="TextSegElementIdentifier">v</span>:<span class="TextSegElementIdentifier">k</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">k</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">v</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">()}</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">177</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Special tokens {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">190</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">info</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Special tokens {}&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">178</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">191</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">179</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">bpe</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">192</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">bpe</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">193</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">eot_pat</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">fullmatch</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">token</span><span class="TextSegSigDiff">)</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">194</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">return</span> <span class="TextSegSigDiff">token</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">180</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span>:</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">195</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">181</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">196</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">182</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">197</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">183</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">198</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">184</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">199</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">185</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">pairs</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">200</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">pairs</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">186</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">token</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">201</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">token</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">187</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">202</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">188</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">while</span> <span class="TextSegElementKeyword">True</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">203</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">while</span> <span class="TextSegElementKeyword">True</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">189</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bigram</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">min</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pairs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">key</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">pair</span>: <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pair</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">float</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'inf'</span><span class="TextSegElementOperator">)))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">204</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bigram</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">min</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pairs</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">key</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">pair</span>: <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">pair</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">float</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'inf'</span><span class="TextSegElementOperator">)))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">190</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">bigram</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">205</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">bigram</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">191</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">206</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">192</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">second</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bigram</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">207</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">second</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bigram</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">193</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">208</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">194</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">=</span> 0</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">209</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">=</span> 0</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">195</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">while</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">&lt;</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">210</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">while</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">&lt;</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">196</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">try</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">211</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">try</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">197</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">j</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">index</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">212</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">j</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">index</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">198</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">extend</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span>:<span class="TextSegElementIdentifier">j</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">213</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">extend</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span>:<span class="TextSegElementIdentifier">j</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">199</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">j</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">214</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">j</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">200</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">except</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">215</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">except</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">201</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">extend</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span>:<span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">216</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">extend</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span>:<span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">202</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">217</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">203</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">218</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">204</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">first</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">&lt;</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)-</span>1 <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">+</span>1<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">second</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">219</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">first</span> <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">&lt;</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)-</span>1 <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">+</span>1<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> <span class="TextSegElementIdentifier">second</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">205</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">+</span><span class="TextSegElementIdentifier">second</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">220</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">first</span><span class="TextSegElementOperator">+</span><span class="TextSegElementIdentifier">second</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">206</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">+=</span> 2</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">221</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">+=</span> 2</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">207</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">222</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">208</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">223</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">209</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">+=</span> 1</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">224</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">i</span> <span class="TextSegElementOperator">+=</span> 1</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">210</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">225</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">new_word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">tuple</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">new_word</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">211</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">new_word</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">226</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">new_word</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">212</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">==</span> 1:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">227</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">==</span> 1:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">213</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">228</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">break</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">214</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">229</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">215</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">230</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">pairs</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">get_pairs</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">216</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">' '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">231</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">word</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">' '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">word</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">217</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">232</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">cache</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">word</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">218</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">word</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">233</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">word</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">219</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">234</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">-+</td>
<td class="TextItemNum AlignRight">235</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp;&nbsp; </span><span class="TextSegSigDiff">def</span> <span class="TextSegSigDiff">separate_eot_tokens</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">)</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">236</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">last_end_index</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">0</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">237</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">for</span> <span class="TextSegSigDiff">m</span> <span class="TextSegSigDiff">in</span> <span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">eot_pat</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">finditer</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">)</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">238</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">last_end_index</span> <span class="TextSegSigDiff">&lt;</span> <span class="TextSegSigDiff">m</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">start</span><span class="TextSegSigDiff">()</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">239</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">yield</span> <span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">last_end_index</span><span class="TextSegSigDiff">:</span><span class="TextSegSigDiff">m</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">start</span><span class="TextSegSigDiff">()]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">240</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">yield</span> <span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">m</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">start</span><span class="TextSegSigDiff">()</span><span class="TextSegSigDiff">:</span><span class="TextSegSigDiff">m</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">end</span><span class="TextSegSigDiff">()]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">241</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">last_end_index</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">m</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">end</span><span class="TextSegSigDiff">()</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">242</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">last_end_index</span> <span class="TextSegSigDiff">&lt;</span> <span class="TextSegSigDiff">len</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">)</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">243</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">yield</span> <span class="TextSegSigDiff">text</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">last_end_index</span><span class="TextSegSigDiff">:</span><span class="TextSegSigDiff">]</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">244</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">220</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">tokenize</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">245</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">tokenize</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">221</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Tokenize a string. &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">246</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Tokenize a string. &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">222</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">247</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">bpe_tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">223</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for <span class="TextSegSigDiff">tok</span>en in <span class="TextSegSigDiff">re</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">findall</span><span class="TextSegSigDiff">(</span>self.pa<span class="TextSegSigDiff">t</span><span class="TextSegSigDiff">,</span> text):</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="TextItemNum AlignRight">248</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for <span class="TextSegSigDiff">segm</span>en<span class="TextSegSigDiff">t</span> in self.<span class="TextSegSigDiff">se</span>pa<span class="TextSegSigDiff">rate_eot_tokens</span><span class="TextSegSigDiff">(</span>text):</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">249</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">eot_pat</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">fullmatch</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">segment</span><span class="TextSegSigDiff">)</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">224</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="TextSegSigDiff">if</span> s<span class="TextSegSigDiff">y</span>s<span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">v</span><span class="TextSegSigDiff">ersion_info</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">0</span>] <span class="TextSegSigDiff">==</span> <span class="TextSegSigDiff">2:</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">250</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="TextSegSigDiff">&nbsp; &nbsp; </span><span class="TextSegSigDiff">token</span>s <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">[</span>s<span class="TextSegSigDiff">egme</span><span class="TextSegSigDiff">nt</span>]</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">225</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">token</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">''</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">join</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">byte_encoder</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">ord</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">b</span><span class="TextSegSigDiff">)]</span> <span class="TextSegSigDiff">for</span> <span class="TextSegSigDiff">b</span> <span class="TextSegSigDiff">in</span> <span class="TextSegSigDiff">token</span><span class="TextSegSigDiff">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionAll">
<td class="TextItemNum AlignRight">226</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">251</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&lt;&gt;</td>
<td class="TextItemNum AlignRight">252</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">tokens</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">re</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">findall</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">pat</span><span class="TextSegSigDiff">,</span> <span class="TextSegSigDiff">segment</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">253</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">for</span> <span class="TextSegSigDiff">token</span> <span class="TextSegSigDiff">in</span> <span class="TextSegSigDiff">tokens</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">254</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">if</span> <span class="TextSegSigDiff">sys</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">version_info</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">0</span><span class="TextSegSigDiff">]</span> <span class="TextSegSigDiff">==</span> <span class="TextSegSigDiff">2:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">255</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">token</span> <span class="TextSegSigDiff">=</span> <span class="TextSegSigDiff">''</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">join</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">self</span><span class="TextSegSigDiff">.</span><span class="TextSegSigDiff">byte_encoder</span><span class="TextSegSigDiff">[</span><span class="TextSegSigDiff">ord</span><span class="TextSegSigDiff">(</span><span class="TextSegSigDiff">b</span><span class="TextSegSigDiff">)]</span> <span class="TextSegSigDiff">for</span> <span class="TextSegSigDiff">b</span> <span class="TextSegSigDiff">in</span> <span class="TextSegSigDiff">token</span><span class="TextSegSigDiff">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">&nbsp;</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">256</td>
<td class="TextItemSigMod"><span class="TextSegSigDiff">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegSigDiff">else</span><span class="TextSegSigDiff">:</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">227</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; token = ''.join(self.byte_encoder[b] for b in token.encode('utf-8'))</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">257</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="TextSegSigDiff">&nbsp; &nbsp; </span>token = ''.join(self.byte_encoder[b] for b in token.encode('utf-8'))</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">228</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; bpe_tokens.extend(bpe_token for bpe_token in self.bpe(token).split(' '))</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">258</td>
<td class="TextItemSigMod">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="TextSegSigDiff">&nbsp; &nbsp; </span>bpe_tokens.extend(bpe_token for bpe_token in self.bpe(token).split(' '))</td>
</tr>
<tr class="SectionBegin">
<td class="TextItemNum AlignRight">229</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">bpe_tokens</span></td>
<td class="AlignCenter">=</td>
<td class="TextItemNum AlignRight">259</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">bpe_tokens</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">230</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">260</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">231</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">convert_tokens_to_ids</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">261</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">convert_tokens_to_ids</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">232</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Converts a sequence of tokens into ids using the vocab. &quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">262</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot; Converts a sequence of tokens into ids using the vocab. &quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">233</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">263</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">234</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">isinstance</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">str</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">or</span> <span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">sys</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">version_info</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> 2 <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">isinstance</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">unicode</span><span class="TextSegElementOperator">))</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">264</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">isinstance</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">str</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">or</span> <span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">sys</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">version_info</span><span class="TextSegElementOperator">[</span>0<span class="TextSegElementOperator">]</span> <span class="TextSegElementOperator">==</span> 2 <span class="TextSegElementKeyword">and</span> <span class="TextSegElementIdentifier">isinstance</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">unicode</span><span class="TextSegElementOperator">))</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">235</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">tokens</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">265</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">tokens</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">236</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">266</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">237</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">267</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">238</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> 0<span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">268</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">,</span> 0<span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">239</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">tokens</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">269</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">tokens</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">240</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">270</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">241</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">271</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">242</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">272</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">243</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">,</span> 0<span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">273</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">get</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">,</span> 0<span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">244</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">&gt;</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">274</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">&gt;</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">245</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">275</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">246</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;Token indices sequence length is longer than the specified maximum &quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">276</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;Token indices sequence length is longer than the specified maximum &quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">247</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot; sequence length for this OpenAI GPT model ({} &gt; {}). Running this&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">277</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot; sequence length for this OpenAI GPT model ({} &gt; {}). Running this&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">248</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot; sequence through the model will result in indexing errors&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">278</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot; sequence through the model will result in indexing errors&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">),</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">max_len</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">249</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">279</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">250</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">ids</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">280</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">ids</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">251</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">281</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">252</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">convert_ids_to_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">skip_special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">False</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">282</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">convert_ids_to_tokens</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">ids</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">skip_special_tokens</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">False</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">253</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Converts a sequence of ids in BPE tokens using the vocab.&quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">283</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Converts a sequence of ids in BPE tokens using the vocab.&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">254</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">284</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementOperator">[]</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">255</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">ids</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">285</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">ids</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">256</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">286</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">i</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">257</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">skip_special_tokens</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">287</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">skip_special_tokens</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">258</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">288</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens_decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">259</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">289</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">else</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">260</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">290</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">append</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">i</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">261</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">tokens</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">291</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">tokens</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">262</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">292</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">263</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">encode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">293</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">encode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">264</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">convert_tokens_to_ids</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">tokenize</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">294</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">convert_tokens_to_ids</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">tokenize</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">265</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">295</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">266</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">decode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">296</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">decode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">267</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">text</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">''</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">([</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">])</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">297</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">text</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementString">''</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">([</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">tokens</span><span class="TextSegElementOperator">])</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">268</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">text</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bytearray</span><span class="TextSegElementOperator">([</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">c</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">c</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">]).</span><span class="TextSegElementIdentifier">decode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">298</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">text</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">bytearray</span><span class="TextSegElementOperator">([</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">byte_decoder</span><span class="TextSegElementOperator">[</span><span class="TextSegElementIdentifier">c</span><span class="TextSegElementOperator">]</span> <span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">c</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">text</span><span class="TextSegElementOperator">]).</span><span class="TextSegElementIdentifier">decode</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">=</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">errors</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">269</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">text</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">299</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">text</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">270</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">300</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">271</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">save_vocabulary</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">301</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp;&nbsp; </span><span class="TextSegElementKeyword">def</span> <span class="TextSegElementIdentifier">save_vocabulary</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">272</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Save the tokenizer vocabulary and merge files to a directory.&quot;&quot;&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">302</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementString">&quot;&quot;&quot;Save the tokenizer vocabulary and merge files to a directory.&quot;&quot;&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">273</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">isdir</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">)</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">303</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementKeyword">not</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">isdir</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">)</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">274</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">error</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Vocabulary path ({}) should be a directory&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">304</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">error</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Vocabulary path ({}) should be a directory&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">275</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">305</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">276</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">VOCAB_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">306</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">vocab_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">VOCAB_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">277</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merge_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">MERGES_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">307</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">merge_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">MERGES_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">278</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">308</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">special_tokens_file</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">os</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">path</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_path</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">SPECIAL_TOKENS_NAME</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">279</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">309</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">280</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">'w'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">f</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">310</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">'w'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">f</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">281</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">f</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">json</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">dumps</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">ensure_ascii</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">False</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">311</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">f</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">json</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">dumps</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">ensure_ascii</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">False</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">282</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">312</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">283</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> 0</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">313</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> 0</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">284</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">&quot;w&quot;</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">&quot;utf-8&quot;</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">writer</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">314</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">&quot;w&quot;</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">&quot;utf-8&quot;</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">writer</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">285</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'#version: 0.2\n'</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">315</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'#version: 0.2\n'</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">286</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">bpe_tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token_index</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">sorted</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">(),</span> <span class="TextSegElementIdentifier">key</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">kv</span>: <span class="TextSegElementIdentifier">kv</span><span class="TextSegElementOperator">[</span>1<span class="TextSegElementOperator">])</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">316</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">bpe_tokens</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token_index</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">sorted</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">bpe_ranks</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">(),</span> <span class="TextSegElementIdentifier">key</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">kv</span>: <span class="TextSegElementIdentifier">kv</span><span class="TextSegElementOperator">[</span>1<span class="TextSegElementOperator">])</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">287</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">!=</span> <span class="TextSegElementIdentifier">token_index</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">317</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">!=</span> <span class="TextSegElementIdentifier">token_index</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">288</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Saving vocabulary to {}: BPE merge indices are not consecutive.&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">318</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Saving vocabulary to {}: BPE merge indices are not consecutive.&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">289</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="TextSegElementString">&quot; Please check that the tokenizer is not corrupted!&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">319</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="TextSegElementString">&quot; Please check that the tokenizer is not corrupted!&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">290</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">token_index</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">320</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">token_index</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">291</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">' '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_tokens</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">321</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">' '</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">join</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">bpe_tokens</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">292</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">+=</span> 1</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">322</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">+=</span> 1</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">293</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">323</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">294</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">324</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">len</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">encoder</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">295</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">'w'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">writer</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">325</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">with</span> <span class="TextSegElementIdentifier">open</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementString">'w'</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">encoding</span><span class="TextSegElementOperator">=</span><span class="TextSegElementString">'utf-8'</span><span class="TextSegElementOperator">)</span> <span class="TextSegElementKeyword">as</span> <span class="TextSegElementIdentifier">writer</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">296</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token_index</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">sorted</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">(),</span> <span class="TextSegElementIdentifier">key</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">kv</span>: <span class="TextSegElementIdentifier">kv</span><span class="TextSegElementOperator">[</span>1<span class="TextSegElementOperator">])</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">326</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">for</span> <span class="TextSegElementIdentifier">token</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">token_index</span> <span class="TextSegElementKeyword">in</span> <span class="TextSegElementIdentifier">sorted</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">self</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">special_tokens</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">items</span><span class="TextSegElementOperator">(),</span> <span class="TextSegElementIdentifier">key</span><span class="TextSegElementOperator">=</span><span class="TextSegElementKeyword">lambda</span> <span class="TextSegElementIdentifier">kv</span>: <span class="TextSegElementIdentifier">kv</span><span class="TextSegElementOperator">[</span>1<span class="TextSegElementOperator">])</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">297</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">!=</span> <span class="TextSegElementIdentifier">token_index</span>:</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">327</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">if</span> <span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">!=</span> <span class="TextSegElementIdentifier">token_index</span>:</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">298</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Saving special tokens vocabulary to {}: BPE indices are not consecutive.&quot;</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">328</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">logger</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">warning</span><span class="TextSegElementOperator">(</span><span class="TextSegElementString">&quot;Saving special tokens vocabulary to {}: BPE indices are not consecutive.&quot;</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">299</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="TextSegElementString">&quot; Please check that the tokenizer is not corrupted!&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">))</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">329</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="TextSegElementString">&quot; Please check that the tokenizer is not corrupted!&quot;</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">format</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">special_tokens_file</span><span class="TextSegElementOperator">))</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">300</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">token_index</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">330</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">=</span> <span class="TextSegElementIdentifier">token_index</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">301</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">331</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">writer</span><span class="TextSegElementOperator">.</span><span class="TextSegElementIdentifier">write</span><span class="TextSegElementOperator">(</span><span class="TextSegElementIdentifier">token</span> <span class="TextSegElementOperator">+</span> <span class="TextSegElementIdentifier">u</span><span class="TextSegElementString">'\n'</span><span class="TextSegElementOperator">)</span></td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">302</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">+=</span> 1</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">332</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementIdentifier">index</span> <span class="TextSegElementOperator">+=</span> 1</td>
</tr>
<tr class="SectionMiddle">
<td class="TextItemNum AlignRight">303</td>
<td class="TextItemSame">&nbsp;</td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">333</td>
<td class="TextItemSame">&nbsp;</td>
</tr>
<tr class="SectionEnd">
<td class="TextItemNum AlignRight">304</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens_file</span></td>
<td class="AlignCenter">&nbsp;</td>
<td class="TextItemNum AlignRight">334</td>
<td class="TextItemSame"><span class="TextSegElementIndentation">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="TextSegElementKeyword">return</span> <span class="TextSegElementIdentifier">vocab_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">merge_file</span><span class="TextSegElementOperator">,</span> <span class="TextSegElementIdentifier">special_tokens_file</span></td>
</tr>
</table>
<br>
</body>
</html>
